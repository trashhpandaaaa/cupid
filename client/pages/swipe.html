<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Swipe - Cupido</title>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?display=swap&family=Noto+Sans:wght@400;500;700;900&family=Plus+Jakarta+Sans:wght@400;500;700;800">
    
    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link rel="stylesheet" href="assets/styles/main.css">
    <link rel="stylesheet" href="assets/styles/components.css">
    <link rel="stylesheet" href="assets/styles/utilities.css">
</head>

<body class="bg-brutalist-dark-pink" style='font-family: "Plus Jakarta Sans", "Noto Sans", sans-serif;'>
    <div class="relative flex size-full min-h-screen flex-col overflow-x-hidden group/design-root">
        <div class="layout-container flex h-full grow flex-col">
            
            <!-- Header -->
            <header class="site-header">
                <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="flex items-center justify-between py-4">
                        <!-- Logo -->
                        <div class="flex items-center gap-3">                     
                            <h1 class="text-2xl sm:text-3xl font-black leading-tight tracking-tighter text-black">
                                <a href="home.html" class="hover:text-[var(--dark-pink-800)] transition-colors">Cupid</a>
                            </h1>
                        </div>
                        
                        <!-- Desktop Navigation -->
                        <nav class="hidden md:flex items-center gap-6">
                            <a class="nav-link" href="discover.html">Home</a>
                            <a class="nav-link" href="swipe.html">Swipe</a>
                            <a class="nav-link" href="messages.html">Messages</a>
                            <a class="nav-link" href="profile.html">Profile</a>
                            <button id="logoutBtn" class="btn-secondary">Logout</button>
                        </nav>
                        <!-- Mobile Menu Button -->
                        <div class="md:hidden">
                            <button id="mobile-menu-toggle" class="p-2 text-[var(--dark-pink-800)] hover:text-black" aria-label="Toggle menu">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <!-- Mobile Menu -->
                    <div id="mobile-menu" class="hidden md:hidden bg-[var(--dark-pink-200)] border-t-2 border-black">
                        <div class="px-4 py-2 space-y-2">
                            <a class="block py-2 text-black hover:text-[var(--dark-pink-800)] transition-colors" href="login.html">Login</a>
                            <a class="block py-2 text-black hover:text-[var(--dark-pink-800)] transition-colors" href="signup.html">Sign Up</a>
                        </div>
                    </div>
                </div>
            </header>

            <!-- Main Content -->
            <main class="flex-1 flex items-center justify-center py-8">
                <div class="container mx-auto px-4 sm:px-6 lg:px-8">
                    <div class="max-w-md mx-auto">
                        
                        <!-- Swipe Stack Container -->
                        <div class="relative h-[600px] mb-8" id="swipeContainer">
                            <!-- Card Stack -->
                            <div class="swipe-card absolute inset-0 card overflow-hidden cursor-grab active:cursor-grabbing" id="card1">
                                <img src="assets/images/default-avatar.png" alt="Profile" class="w-full h-3/5 object-cover">
                                <div class="p-6 h-2/5 flex flex-col justify-between">
                                    <div>
                                        <h3 class="text-2xl font-bold text-black mb-2">Emma, 25</h3>
                                        <p class="text-sm text-[var(--dark-pink-800)] mb-2">üìç 2 miles away</p>
                                        <p class="text-sm text-black">Love hiking, coffee, and good conversations. Looking for someone genuine to explore life with.</p>
                                    </div>
                                </div>
                                <!-- Swipe Indicators -->
                                <div class="absolute top-8 left-8 bg-red-500 text-white px-4 py-2 rounded-full font-bold text-lg opacity-0 transition-opacity" id="nopeIndicator1">NOPE</div>
                                <div class="absolute top-8 right-8 bg-green-500 text-white px-4 py-2 rounded-full font-bold text-lg opacity-0 transition-opacity" id="likeIndicator1">LIKE</div>
                            </div>

                            <div class="swipe-card absolute card overflow-hidden cursor-grab active:cursor-grabbing book-stack-card-2" id="card2" style="z-index: -1;">
                                <img src="assets/images/default-avatar.png" alt="Profile" class="w-full h-3/5 object-cover">
                                <div class="p-6 h-2/5 flex flex-col justify-between">
                                    <div>
                                        <h3 class="text-2xl font-bold text-black mb-2">Alex, 28</h3>
                                        <p class="text-sm text-[var(--dark-pink-800)] mb-2">üìç 5 miles away</p>
                                        <p class="text-sm text-black">Photographer and world traveler. Seeking an adventure companion to share stories with.</p>
                                    </div>
                                </div>
                                <div class="absolute top-8 left-8 bg-red-500 text-white px-4 py-2 rounded-full font-bold text-lg opacity-0 transition-opacity" id="nopeIndicator2">NOPE</div>
                                <div class="absolute top-8 right-8 bg-green-500 text-white px-4 py-2 rounded-full font-bold text-lg opacity-0 transition-opacity" id="likeIndicator2">LIKE</div>
                            </div>

                            <div class="swipe-card absolute card overflow-hidden cursor-grab active:cursor-grabbing book-stack-card-3" id="card3" style="z-index: -2;">
                                <img src="assets/images/default-avatar.png" alt="Profile" class="w-full h-3/5 object-cover">
                                <div class="p-6 h-2/5 flex flex-col justify-between">
                                    <div>
                                        <h3 class="text-2xl font-bold text-black mb-2">Sarah, 26</h3>
                                        <p class="text-sm text-[var(--dark-pink-800)] mb-2">üìç 3 miles away</p>
                                        <p class="text-sm text-black">Book lover and yoga enthusiast. Let's explore the city together and find hidden gems!</p>
                                    </div>
                                </div>
                                <div class="absolute top-8 left-8 bg-red-500 text-white px-4 py-2 rounded-full font-bold text-lg opacity-0 transition-opacity" id="nopeIndicator3">NOPE</div>
                                <div class="absolute top-8 right-8 bg-green-500 text-white px-4 py-2 rounded-full font-bold text-lg opacity-0 transition-opacity" id="likeIndicator3">LIKE</div>
                            </div>
                        </div>

                        <!-- Action Buttons -->
                        <div class="flex justify-center gap-6 mb-8">
                            <button id="passBtn" class="w-16 h-16 bg-white border-4 border-red-500 rounded-full flex items-center justify-center hover:bg-red-50 transition-colors">
                                <svg class="w-8 h-8 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M6 18L18 6M6 6l12 12"></path>
                                </svg>
                            </button>
                            
                            <button id="superLikeBtn" class="w-16 h-16 bg-white border-4 border-blue-500 rounded-full flex items-center justify-center hover:bg-blue-50 transition-colors">
                                <svg class="w-8 h-8 text-blue-500" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                                </svg>
                            </button>
                            
                            <button id="likeBtn" class="w-16 h-16 bg-white border-4 border-green-500 rounded-full flex items-center justify-center hover:bg-green-50 transition-colors">
                                <svg class="w-8 h-8 text-green-500" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                                </svg>
                            </button>
                        </div>

                        <!-- No More Cards Message -->
                        <div id="noMoreCards" class="text-center card p-8 hidden">
                            <div class="mb-4">
                                <svg class="w-16 h-16 mx-auto text-[var(--dark-pink-500)]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"></path>
                                </svg>
                            </div>
                            <h3 class="text-2xl font-bold text-black mb-2">That's everyone for now!</h3>
                            <p class="text-[var(--dark-pink-800)] mb-4">Check back later for more profiles, or explore other features.</p>
                            <div class="flex gap-4 justify-center">
                                <a href="discover.html" class="btn-primary">Browse Profiles</a>
                                <a href="messages.html" class="btn-secondary">View Messages</a>
                            </div>
                        </div>
                    </div>
                </div>
            </main>

            <!-- Footer -->
            <footer class="text-center py-6 border-t-2 border-black bg-[var(--dark-pink-200)] bg-opacity-50">
                <div class="container mx-auto px-4 sm:px-6">        
                    <p class="text-sm text-[var(--dark-pink-800)]">
                        ¬© 2025 Cupido. All rights reserved. Find love, authentically.
                    </p>
                </div>
            </footer>
        </div>
    </div>

    <!-- JavaScript -->
    <script src="assets/js/main.js"></script>
    <style>
        /* Additional swipe-specific styles */
        .swipe-card {
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            transition: all 0.3s ease;
        }
        
        .swipe-card img {
            pointer-events: none;
            user-select: none;
            -webkit-user-drag: none;
        }
        
        #swipeContainer {
            touch-action: none;
            perspective: 1000px;
        }
        
        .card {
            border: 3px solid #2c1810;
            border-radius: 12px;
            background: #f8f6f0;
            position: relative;
        }
        
        /* Book stack effect */
        .swipe-card {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 12px;
            background: linear-gradient(145deg, #f8f6f0 0%, #ebe7db 100%);
        }
        
        /* Top card (active) */
        .swipe-card:first-child {
            z-index: 3;
            transform: translateY(0px) scale(1);
            box-shadow: 
                0 25px 50px rgba(44, 24, 16, 0.25),
                0 15px 25px rgba(44, 24, 16, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
        }
        
        /* Second card */
        .book-stack-card-2 {
            z-index: 2 !important;
            transform: translateY(8px) translateX(-4px) scale(0.96) !important;
            box-shadow: 
                0 20px 40px rgba(44, 24, 16, 0.2),
                0 10px 20px rgba(44, 24, 16, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.4);
            background: linear-gradient(145deg, #ede9dd 0%, #e0dccf 100%);
            border-color: #3a281f;
        }
        
        /* Third card */
        .book-stack-card-3 {
            z-index: 1 !important;
            transform: translateY(16px) translateX(-8px) scale(0.92) !important;
            box-shadow: 
                0 15px 30px rgba(44, 24, 16, 0.15),
                0 8px 16px rgba(44, 24, 16, 0.08),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            background: linear-gradient(145deg, #e2dec2 0%, #d5d1c3 100%);
            border-color: #453020;
        }
        
        /* Book spine effect on the side */
        .swipe-card::before {
            content: '';
            position: absolute;
            left: -3px;
            top: 0;
            width: 6px;
            height: 100%;
            background: linear-gradient(180deg, #8b4513, #654321);
            border-radius: 3px 0 0 3px;
            z-index: -1;
        }
        
        .book-stack-card-2::before {
            background: linear-gradient(180deg, #7a3e0f, #563015);
        }
        
        .book-stack-card-3::before {
            background: linear-gradient(180deg, #693509, #4a2611);
        }
        
        /* Book pages effect */
        .swipe-card::after {
            content: '';
            position: absolute;
            right: 2px;
            top: 2px;
            bottom: 2px;
            width: 8px;
            background: repeating-linear-gradient(
                0deg,
                transparent,
                transparent 2px,
                rgba(44, 24, 16, 0.1) 2px,
                rgba(44, 24, 16, 0.1) 3px
            );
            border-radius: 0 8px 8px 0;
        }
        
        /* Hover effects for book stack */
        .swipe-card:hover {
            transform: translateY(-2px) scale(1.01);
        }
        
        .book-stack-card-2:hover {
            transform: translateY(6px) translateX(-4px) scale(0.97) !important;
        }
        
        .book-stack-card-3:hover {
            transform: translateY(14px) translateX(-8px) scale(0.93) !important;
        }
    </style>
    <script>
        let currentCardIndex = 0;
        const cards = ['card1', 'card2', 'card3'];
        let isDragging = false;
        let startX = 0;
        let currentX = 0;
        let cardBeingDragged = null;

        // Sample profiles for cycling
        const profiles = [
            { name: "Emma, 25", location: "2 miles away", bio: "Love hiking, coffee, and good conversations. Looking for someone genuine to explore life with." },
            { name: "Alex, 28", location: "5 miles away", bio: "Photographer and world traveler. Seeking an adventure companion to share stories with." },
            { name: "Sarah, 26", location: "3 miles away", bio: "Book lover and yoga enthusiast. Let's explore the city together and find hidden gems!" },
            { name: "Mike, 30", location: "7 miles away", bio: "Chef and foodie. Let me cook for you on our first date!" },
            { name: "Lisa, 24", location: "4 miles away", bio: "Artist and music lover. Looking for my creative soulmate." },
            { name: "James, 29", location: "6 miles away", bio: "Tech enthusiast and dog lover. Swipe right if you love Golden Retrievers!" }
        ];

        let profileIndex = 3; // Start after the initial 3 profiles

        // Mobile menu toggle
        const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
        const mobileMenu = document.getElementById('mobile-menu');
        
        if (mobileMenuToggle && mobileMenu) {
            mobileMenuToggle.addEventListener('click', function() {
                mobileMenu.classList.toggle('hidden');
            });
            
            // Close mobile menu when clicking outside
            document.addEventListener('click', function(e) {
                if (!mobileMenu.contains(e.target) && !mobileMenuToggle.contains(e.target)) {
                    mobileMenu.classList.add('hidden');
                }
            });
        }

        // Button event listeners
        document.getElementById('passBtn').addEventListener('click', () => swipeCard('left'));
        document.getElementById('likeBtn').addEventListener('click', () => swipeCard('right'));
        document.getElementById('superLikeBtn').addEventListener('click', () => swipeCard('up'));

        // Touch/Mouse events for swipe functionality
        function initializeCardEvents() {
            cards.forEach(cardId => {
                const card = document.getElementById(cardId);
                if (!card) return;
                
                // Mouse events
                card.addEventListener('mousedown', startDrag, { passive: false });
                document.addEventListener('mousemove', drag, { passive: false });
                document.addEventListener('mouseup', endDrag);
                
                // Touch events
                card.addEventListener('touchstart', startDrag, { passive: false });
                card.addEventListener('touchmove', drag, { passive: false });
                card.addEventListener('touchend', endDrag);
            });
        }
        
        initializeCardEvents();

        function startDrag(e) {
            const targetCard = e.target.closest('.swipe-card');
            if (!targetCard || targetCard.id !== cards[currentCardIndex]) return;
            
            e.preventDefault();
            isDragging = true;
            cardBeingDragged = targetCard;
            
            const clientX = e.type === 'mousedown' ? e.clientX : 
                           e.touches && e.touches[0] ? e.touches[0].clientX : 0;
            startX = clientX;
            
            if (cardBeingDragged) {
                cardBeingDragged.style.transition = 'none';
                cardBeingDragged.style.cursor = 'grabbing';
            }
        }

        function drag(e) {
            if (!isDragging || !cardBeingDragged) return;
            
            e.preventDefault();
            
            const clientX = e.type === 'mousemove' ? e.clientX : 
                           e.touches && e.touches[0] ? e.touches[0].clientX : 0;
            currentX = clientX - startX;
            
            const rotation = currentX * 0.1;
            const lift = Math.abs(currentX) * 0.2; // Lift the card as it's dragged
            
            cardBeingDragged.style.transform = `translateX(${currentX}px) translateY(-${lift}px) rotate(${rotation}deg) scale(1.05)`;
            cardBeingDragged.style.boxShadow = `
                0 ${30 + lift}px ${60 + lift}px rgba(44, 24, 16, 0.3),
                0 ${20 + lift}px ${30 + lift}px rgba(44, 24, 16, 0.2)
            `;
            
            // Show indicators based on swipe direction
            const likeIndicator = cardBeingDragged.querySelector('[id^="likeIndicator"]');
            const nopeIndicator = cardBeingDragged.querySelector('[id^="nopeIndicator"]');
            
            if (likeIndicator && nopeIndicator) {
                if (currentX > 50) {
                    likeIndicator.style.opacity = Math.min(1, (currentX - 50) / 100);
                    nopeIndicator.style.opacity = 0;
                } else if (currentX < -50) {
                    nopeIndicator.style.opacity = Math.min(1, (-currentX - 50) / 100);
                    likeIndicator.style.opacity = 0;
                } else {
                    likeIndicator.style.opacity = 0;
                    nopeIndicator.style.opacity = 0;
                }
            }
        }

        function endDrag(e) {
            if (!isDragging || !cardBeingDragged) return;
            
            isDragging = false;
            
            if (cardBeingDragged) {
                cardBeingDragged.style.cursor = 'grab';
                
                if (Math.abs(currentX) > 100) {
                    // Complete the swipe
                    const direction = currentX > 0 ? 'right' : 'left';
                    completeSwipe(cardBeingDragged, direction);
                } else {
                    // Snap back to book stack position
                    cardBeingDragged.style.transition = 'transform 0.3s ease, box-shadow 0.3s ease';
                    cardBeingDragged.style.transform = 'translateY(0px) scale(1)';
                    cardBeingDragged.style.boxShadow = `
                        0 25px 50px rgba(44, 24, 16, 0.25),
                        0 15px 25px rgba(44, 24, 16, 0.15),
                        inset 0 1px 0 rgba(255, 255, 255, 0.6)
                    `;
                    
                    // Hide indicators
                    const likeIndicator = cardBeingDragged.querySelector('[id^="likeIndicator"]');
                    const nopeIndicator = cardBeingDragged.querySelector('[id^="nopeIndicator"]');
                    if (likeIndicator) likeIndicator.style.opacity = 0;
                    if (nopeIndicator) nopeIndicator.style.opacity = 0;
                }
            }
            
            cardBeingDragged = null;
            currentX = 0;
        }

        function swipeCard(direction) {
            const currentCard = document.getElementById(cards[currentCardIndex]);
            completeSwipe(currentCard, direction);
        }

        function completeSwipe(card, direction) {
            const translateX = direction === 'right' ? '100vw' : direction === 'left' ? '-100vw' : '0';
            const translateY = direction === 'up' ? '-100vh' : '0';
            
            card.style.transition = 'transform 0.5s ease';
            card.style.transform = `translateX(${translateX}) translateY(${translateY}) rotate(${direction === 'right' ? '30deg' : direction === 'left' ? '-30deg' : '0'})`;
            card.style.opacity = '0';
            
            // Update stats
            updateStats(direction);
            
            setTimeout(() => {
                // Hide current card and move to next
                card.style.display = 'none';
                moveToNextCard();
            }, 500);
        }

        function moveToNextCard() {
            currentCardIndex++;
            
            if (currentCardIndex >= cards.length) {
                // Show no more cards message
                document.getElementById('swipeContainer').style.display = 'none';
                document.getElementById('noMoreCards').classList.remove('hidden');
                return;
            }
            
            // Update book stack positioning
            for (let i = currentCardIndex; i < cards.length; i++) {
                const card = document.getElementById(cards[i]);
                const stackPosition = i - currentCardIndex;
                
                // Remove existing classes
                card.classList.remove('book-stack-card-2', 'book-stack-card-3');
                
                if (stackPosition === 0) {
                    // Top card (active)
                    card.style.zIndex = 3;
                    card.style.transform = 'translateY(0px) scale(1)';
                } else if (stackPosition === 1) {
                    // Second card
                    card.classList.add('book-stack-card-2');
                    card.style.zIndex = 2;
                    card.style.transform = 'translateY(8px) translateX(-4px) scale(0.96)';
                } else if (stackPosition === 2) {
                    // Third card
                    card.classList.add('book-stack-card-3');
                    card.style.zIndex = 1;
                    card.style.transform = 'translateY(16px) translateX(-8px) scale(0.92)';
                }
            }
            
            // Load new profile for the last card if available
            if (profileIndex < profiles.length) {
                loadNewProfile();
            }
        }

        function loadNewProfile() {
            if (profileIndex >= profiles.length) return;
            
            const lastCardIndex = (currentCardIndex + 2) % cards.length;
            const lastCard = document.getElementById(cards[lastCardIndex]);
            const profile = profiles[profileIndex];
            
            if (!lastCard || !profile) return;
            
            try {
                // Update card content
                const nameElement = lastCard.querySelector('h3');
                const locationElement = lastCard.querySelector('p');
                const bioElement = lastCard.querySelectorAll('p')[1];
                
                if (nameElement) nameElement.textContent = profile.name;
                if (locationElement) locationElement.textContent = `üìç ${profile.location}`;
                if (bioElement) bioElement.textContent = profile.bio;
                
                // Reset card state and apply book stack positioning
                lastCard.style.display = 'block';
                lastCard.style.opacity = '1';
                lastCard.style.transition = '';
                
                // Set as third card in stack
                lastCard.classList.remove('book-stack-card-2');
                lastCard.classList.add('book-stack-card-3');
                lastCard.style.zIndex = '1';
                lastCard.style.transform = 'translateY(16px) translateX(-8px) scale(0.92)';
                
                // Hide indicators
                const likeIndicator = lastCard.querySelector('[id^="likeIndicator"]');
                const nopeIndicator = lastCard.querySelector('[id^="nopeIndicator"]');
                if (likeIndicator) likeIndicator.style.opacity = 0;
                if (nopeIndicator) nopeIndicator.style.opacity = 0;
                
                profileIndex++;
            } catch (error) {
                console.error('Error loading new profile:', error);
            }
        }

        function updateStats(direction) {
            try {
                const swipesLeftElement = document.getElementById('swipesLeft');
                const likesCountElement = document.getElementById('likesCount');
                const matchesCountElement = document.getElementById('matchesCount');
                
                if (!swipesLeftElement || !likesCountElement || !matchesCountElement) {
                    console.error('Stats elements not found');
                    return;
                }
                
                let swipesLeft = parseInt(swipesLeftElement.textContent) || 0;
                swipesLeft = Math.max(0, swipesLeft - 1);
                swipesLeftElement.textContent = swipesLeft;
                
                if (direction === 'right' || direction === 'up') {
                    let likesCount = parseInt(likesCountElement.textContent) || 0;
                    likesCount++;
                    likesCountElement.textContent = likesCount;
                    
                    // Random chance of match
                    if (Math.random() > 0.7) {
                        let matchesCount = parseInt(matchesCountElement.textContent) || 0;
                        matchesCount++;
                        matchesCountElement.textContent = matchesCount;
                        
                        // Show match notification
                        setTimeout(() => {
                            alert('It\'s a Match! You can now start chatting.');
                        }, 600);
                    }
                }
            } catch (error) {
                console.error('Error updating stats:', error);
            }
        }

        // Prevent default drag behavior on images
        document.querySelectorAll('img').forEach(img => {
            img.addEventListener('dragstart', e => e.preventDefault());
        });

        // Logout functionality
        document.getElementById('logoutBtn').addEventListener('click', function() {
            if (confirm('Are you sure you want to logout?')) {
                // Clear stored tokens
                localStorage.removeItem('token');
                sessionStorage.removeItem('token');
                
                // Redirect to login page
                window.location.href = 'login.html';
            }
        });
    </script>
</body>
</html>
