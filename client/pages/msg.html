<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Messages - Cupid</title>
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?display=swap&family=Noto+Sans:wght@400;500;700;900&family=Plus+Jakarta+Sans:wght@400;500;700;800"
    />

    <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
    <link rel="stylesheet" href="assets/styles/main.css" />
    <link rel="stylesheet" href="assets/styles/components.css" />
    <link rel="stylesheet" href="assets/styles/utilities.css" />

    <!-- Custom CSS to prevent hover animations -->
    <style>
      /* Remove any hover effects on conversation items */
      .conversation-item:hover {
        transform: none !important;
        box-shadow: none !important;
        transition: none !important;
        background-color: inherit !important;
      }

      /* Remove any hover effects on cards */
      .card:hover {
        transform: none !important;
        box-shadow: none !important;
        transition: none !important;
      }

      /* Remove any hover effects on message boxes */
      .max-w-xs:hover,
      .max-w-sm:hover,
      .max-w-md:hover {
        transform: none !important;
        box-shadow: none !important;
        transition: none !important;
      }

      /* Override any general hover animations */
      div:hover {
        transform: none !important;
      }

      /* Ensure no lifting animations on rounded elements */
      .rounded-lg:hover {
        transform: none !important;
        box-shadow: none !important;
        transition: none !important;
      }
    </style>
    <script src="assets/js/login.js"></script>
  </head>

  <body
    class="bg-brutalist-dark-pink"
    style="font-family: 'Plus Jakarta Sans', 'Noto Sans', sans-serif"
  >
    <div
      class="relative flex size-full min-h-screen flex-col overflow-x-hidden group/design-root"
    >
      <div class="layout-container flex h-full grow flex-col">
        <!-- Header -->
        <header class="site-header">
          <div class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between py-4">
              <!-- Logo -->
              <div class="flex items-center gap-3">
                <h1
                  class="text-2xl sm:text-3xl font-black leading-tight tracking-tighter text-black"
                >
                  <a href="home.html" class="text-[var(--dark-pink-800)]"
                    >Cupid</a
                  >
                </h1>
              </div>

              <!-- Desktop Navigation -->
              <nav class="hidden md:flex items-center gap-6">
                <a class="nav-link" href="discover.html">Home</a>
                <a class="nav-link" href="swipe.html">Swipe</a>
                <a class="nav-link" href="messages.html">Messages</a>
                <a class="nav-link" href="profile.html">Profile</a>
                <button id="logoutBtn" class="btn-primary">Logout</button>
              </nav>

              <!-- Mobile Menu Button -->
              <div class="md:hidden">
                <button
                  id="mobile-menu-toggle"
                  class="p-2 text-[var(--dark-pink-800)]"
                  aria-label="Toggle menu"
                >
                  <svg
                    class="w-6 h-6"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M4 6h16M4 12h16m-7 6h7"
                    ></path>
                  </svg>
                </button>
              </div>
            </div>

            <!-- Mobile Menu -->
            <nav
              id="mobile-menu"
              class="md:hidden hidden border-t-2 border-black py-4"
            >
              <div class="flex flex-col gap-4 px-4">
                <a
                  href="login.html"
                  class="btn-secondary inline-block text-center"
                  >Login</a
                >
                <a
                  href="signup.html"
                  class="btn-primary inline-block text-center"
                  >Sign Up</a
                >
              </div>
            </nav>
          </div>
        </header>

        <main class="flex flex-grow overflow-hidden">
          <!-- Sidebar: Conversation List -->
          <aside
            class="w-1/3 max-w-sm bg-[var(--dark-pink-100)] border-r-2 border-black overflow-y-auto"
          >
            <div class="p-4 border-b-2 border-black">
              <h2 class="font-extrabold text-lg text-[var(--dark-pink-800)]">
                Conversations
              </h2>
            </div>
            <ul id="userList" class="divide-y-2 divide-black">
              <li
                class="p-4 cursor-pointer conversation-item hover:bg-[var(--dark-pink-200)]"
              >
                <div id="userVariable" class="font-bold text-[var(--dark-pink-800)]">
                  Alex Johnson
                </div>
                <div class="text-xs text-gray-600">Hey, howâ€™s it going?</div>
              </li>
              <li
                class="p-4 cursor-pointer conversation-item hover:bg-[var(--dark-pink-200)]"
              >
                <div class="font-bold text-[var(--dark-pink-800)]">
                  Jane Doe
                </div>
                <div class="text-xs text-gray-600">Letâ€™s meet tomorrow</div>
              </li>
            </ul>
          </aside>

          <!-- Chat Window -->
          <section
            class="flex-1 flex flex-col justify-between bg-[var(--dark-pink-50)]"
          >
            <!-- Chat Header -->
            <div
              class="px-6 py-4 border-b-2 border-black bg-[var(--dark-pink-100)]"
            >
              <h3 class="font-extrabold text-[var(--dark-pink-800)] text-lg">
                Alex Johnson
              </h3>
            </div>

            <!-- Messages -->
            <div
              id="messageContainer"
              class="flex-1 p-6 space-y-4 overflow-y-auto"
            >
              <!-- Incoming Message -->
              <div
                class="max-w-sm p-3 rounded-xl border-2 border-black bg-white shadow-[4px_4px_0px_black]"
              >
                <p class="text-sm text-black">Hey there! ðŸ‘‹</p>
              </div>

              <!-- Outgoing Message -->
              <div
                class="max-w-sm ml-auto p-3 rounded-xl border-2 border-black bg-[var(--dark-pink-200)] shadow-[4px_4px_0px_black]"
              >
                <p class="text-sm text-black">Hi! Nice to hear from you ðŸ˜„</p>
              </div>
            </div>

            <!-- Input Box -->
            <form
              class="p-4 border-t-2 border-black flex gap-3 bg-[var(--dark-pink-100)]"
            >
              <input
                type="text"
                placeholder="Type your message..."
                class="flex-1 border-2 border-black px-4 py-2 rounded-lg shadow-[2px_2px_0px_black] bg-white focus:outline-none"
              />
              <button
                type="submit"
                class="px-4 py-2 font-bold rounded-lg border-2 border-black bg-[var(--dark-pink-300)] shadow-[2px_2px_0px_black] hover:bg-[var(--dark-pink-400)]"
              >
                Send
              </button>
            </form>
          </section>
        </main>

        <!-- Footer -->
        <footer
          class="text-center py-6 border-t-2 border-black bg-[var(--dark-pink-200)] bg-opacity-50"
        >
          <div class="container mx-auto px-4 sm:px-6">
            <p class="text-sm text-[var(--dark-pink-800)]">
              Â© 2025 Cupid. All rights reserved. Find love, authentically.
            </p>
          </div>
        </footer>
      </div>
    </div>

    <script>
  window.onload = async (e) => {
    let token = localStorage.getItem('token');

    try {
      const response = await fetch('http://localhost:8080/getalluser', {
        method: 'GET',
        headers: {
          'Content-Type': 'application/json',
          authorization: token,
        },
      });

      const data = await response.json();
      const users = Array.isArray(data.users) ? data.users : [];

      const userList = document.getElementById('userList');
      userList.innerHTML = ''; // Clear any static content

      users.forEach((user) => {
        const li = document.createElement('li');
        li.className =
          'p-4 cursor-pointer conversation-item hover:bg-[var(--dark-pink-200)] border-black border-b-2';
        li.innerHTML = `
          <div class="font-bold text-[var(--dark-pink-800)]">${user.name}</div>
          <div class="text-xs text-gray-600">Start chatting!</div>
        `;
        li.addEventListener('click', () => openChatWithUser(user));
        userList.appendChild(li);
      });
    } catch (err) {
      console.error('Error fetching users:', err);
    }
  };

  function openChatWithUser(user) {
    const chatHeader = document.querySelector('section h3');
    chatHeader.textContent = user.name;

    const messageContainer = document.getElementById('messageContainer');
    messageContainer.innerHTML = `
      <div class="max-w-sm p-3 rounded-xl border-2 border-black bg-white shadow-[4px_4px_0px_black]">
        <p class="text-sm text-black">Hi ${user.name}! ðŸ‘‹</p>
      </div>
    `;
  }
</script>


    <!-- JavaScript -->
    <script src="assets/js/main.js"></script>
  </body>
</html>
